CREATE VIEW stock_vista AS
SELECT
al.alm_nombre as almacen,
t.tprd_nombre as tipo,
m.mrc_nombre as marca,
md.mdl_nombre as modelo,
p.prd_descripcion as descripcion,
u.und_nombre as unidad_medida,
SUM(tdet.tscdet_cantidad) as cantidad
from
transaccion_detalle tdet
inner join transaccion_cabecera tcab on
tdet.id_movimiento_cabecera = tcab.idtransaccion_cabecera
inner join almacen al on
tcab.id_almacen = al.idalmacen
inner join producto p on
tdet.id_producto = p.idproducto
inner join modelo md on
p.id_modelo = md.id_modelo
inner join marca m on
md.id_marca = m.id_marca
inner join tipo_producto t on
m.id_tipo_producto = t.id_tipo_producto
inner join unidad_medida u on
t.id_unidad_medida = u.idunidad_medida
where
tcab.tsccab_estado = 1
group by
al.alm_nombre,
tdet.id_producto
order by
al.idalmacen