<mat-card>

  <button mat-mini-fab type="button" color="primary" (click)="Atras()"><mat-icon>keyboard_arrow_left</mat-icon></button>

  <mat-card-title class="tituloProd"> Refinanciamiento de deuda </mat-card-title>



    <mat-horizontal-stepper>
      <mat-step [stepControl]="RefinanciamientoSeleccionForm">

        <!-- Seleccionar cliente -->
        <form [formGroup]="RefinanciamientoSeleccionForm">
          <ng-template matStepLabel>Seleccionar cliente</ng-template>

          <mat-grid-list class="contenido-tab" cols="4" rowHeight="70px">
        
            <mat-grid-tile colspan=3 *ngIf="!RefinanciamientoSeleccionForm.value.id_cliente">
              <button mat-icon-button color="primary" matTooltip="Seleccionar cliente" (click)="SeleccionarCliente()">
                <mat-icon>add_circle</mat-icon>
              </button>
            </mat-grid-tile>
            
            <ng-container *ngIf="RefinanciamientoSeleccionForm.value.id_cliente">
              <mat-grid-tile colspan=2>
                <mat-form-field class="columnas-2">
                  <input matInput placeholder="Cliente" formControlName="cliente_nombre" readonly>
                  <mat-icon color="primary" matSuffix (click)="RemoverCliente()"> remove_circle </mat-icon>
                </mat-form-field>
              </mat-grid-tile>
              
              <mat-grid-tile>
                <mat-form-field class="columnas-1">
                  <span matPrefix> S/. &nbsp; </span>
                  <input matInput placeholder="Total" formControlName="total" readonly>
                </mat-form-field>
              </mat-grid-tile>
            </ng-container>
            
            <mat-grid-tile>
              <button mat-raised-button type="button" color="primary" (click)="BuscarTransacciones()" [disabled]="!RefinanciamientoSeleccionForm.value.id_cliente"> Buscar transacciones </button>
            </mat-grid-tile>
        
          </mat-grid-list>
      
          <mat-card-content>
        
            <mat-table [dataSource]="Listadotransacciones" class="mat-elevation-z8">
          
              <ng-container matColumnDef="numero">
                <mat-header-cell *matHeaderCellDef> N° </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> {{transaccion.numero}} </mat-cell>
              </ng-container>
          
              <ng-container matColumnDef="considerar">
                <mat-header-cell *matHeaderCellDef> Considerar </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> 
                  <mat-checkbox color="primary" (change)="TransaccionSeleccionada($event,transaccion.id)"></mat-checkbox>
                </mat-cell>
              </ng-container>
              
              <ng-container matColumnDef="fecha">
                <mat-header-cell *matHeaderCellDef> Fecha </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> {{transaccion.fecha}}</mat-cell>
              </ng-container>
          
              <ng-container matColumnDef="tipo">
                <mat-header-cell *matHeaderCellDef> Tipo </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> {{transaccion.tipo}} </mat-cell>
              </ng-container>
          
              <ng-container matColumnDef="documento">
                <mat-header-cell *matHeaderCellDef> Documento </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> {{transaccion.documento}} </mat-cell>
              </ng-container>
          
              <ng-container matColumnDef="monto_pendiente">
                <mat-header-cell *matHeaderCellDef> Monto pendiente </mat-header-cell>
                <mat-cell *matCellDef="let transaccion"> {{transaccion.monto_pendiente | currency:'S/.' }} </mat-cell>
              </ng-container>
          
              <mat-header-row *matHeaderRowDef="Columnas"></mat-header-row>
              <mat-row *matRowDef="let row; columns: Columnas;"></mat-row>
            </mat-table>
        
          </mat-card-content>

          <mat-card-actions>
            <mat-grid-list cols="1" rowHeight="40px">
              <mat-grid-tile>
                <button mat-raised-button type="button" color="primary" (click)="TransaccionesSelecionadas()" matStepperNext [disabled]="RefinanciamientoSeleccionForm.invalid"> Guardar </button>
              </mat-grid-tile>
            </mat-grid-list>
          </mat-card-actions>

        </form>

      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Definir cronograma</ng-template>
        Content 2
      </mat-step>
      <mat-step>
        <ng-template matStepLabel>Generar nuevo crédito</ng-template>
        Content 3
      </mat-step>
    </mat-horizontal-stepper>

    <div class = "spinner-container" *ngIf = "Listadotransacciones.Cargando| async">
      <mat-spinner></mat-spinner>
    </div>

</mat-card>